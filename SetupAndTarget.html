<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Debugger-based On-Target Testing: Setup and Requirements</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxyStyle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="dott_ng_logo_small.png"/></td>
  <td id="projectalign">
   <div id="projectname">Debugger-based On-Target Testing
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Setup and Requirements </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md_doc_user_manual_src_setup"></a></p>
<h1>Requirements</h1>
<p >The requirements for your platform consist of the platform-specific requirements (either Windows or Linux) and the general requirements below.</p>
<h2>Windows</h2>
<ul>
<li>tested OS version: <code>Windows 10 (amd64)</code></li>
<li>tested Python versions: <code>Python 3.10.7 and 3.12.0</code> (64bit); used Python distribution: <a href="https://github.com/indygreg/python-build-standalone/releases/">PythonBuilds</a></li>
</ul>
<h2>Linux</h2>
<ul>
<li>tested OS version: <code>Ubuntu 22.04 (amd64)</code>; limited testing was also performed with Manjaro (Arch) Linux (amd64)</li>
<li>tested Python version: <code>Python 3.10.7 and 3.12.0</code> (64bit); used Python distribution: <a href="https://github.com/indygreg/python-build-standalone/releases/">PythonBuilds</a></li>
</ul>
<h2>General</h2>
<h3>Segger J-Link</h3>
<ul>
<li><a href="https://www.segger.com/products/debug-probes/j-link/">Segger J-Link</a> debug probe or STM32 eval board with ST-Link converted to J-Link</li>
<li>Segger <a href="https://www.segger.com/downloads/jlink/#J-LinkSoftwareAndDocumentationPack">J-Link Software Pack</a>. <b>Notice:</b> The following version should be avoided since they have known issues related to SRAM download: v6.50, v6.52(a-c).</li>
</ul>
<p ><b>Recommended</b></p><ul>
<li><a href="https://www.st.com/en/evaluation-tools/nucleo-f072rb.html">STM32F072 Nucleo-64</a> board which is used as reference platform for the examples coming with DOTT.</li>
</ul>
<h3>PE Micro</h3>
<p >As of DOTT version 1.10, first support for P&amp;E Micro debug probes has been added via P&amp;E's gdb server which is shipped free of charge as part of P&amp;E's Eclipse plugin. Note that P&amp;E Micro support in DOTT has not yet undergone as in-depth testing as support for Segger debug probes.</p>
<p >Building the P&amp;E runtime extension for DOTT can be done by clongin the DOTT repository and executing the following commands:</p>
<div class="fragment"><div class="line"># Linux example</div>
<div class="line">$ python -m venv venv_setup</div>
<div class="line">$ . venv_setup/bin/activate</div>
<div class="line">$ pip install setuptools wheel twine</div>
<div class="line">$ cd &lt;YOUR_DOTT_CHECKOUT_PATH&gt;</div>
<div class="line">$ python setup.py bdist_wheel --dott-runtime-pemicro-s32k</div>
</div><!-- fragment --><p >The result of the steps above is a Pyhton package in the <code>dist</code> folder called <code>dott_ng_pemicro_s32k_runtime-5.7.5-py3-none-any.whl</code> (or similar). This package contains the P&amp;E GDB server and support for files for NXP S32K MCUs. If you need support for other MCUs change setup.py accordingly.</p>
<p >Note that the P&amp;E DOTT runtime file needs to be generated by users themselves and is not provided via PyPi.</p>
<p >For Linux systems, a udev rule similar to the following one might be needed for P&amp;E Micro OpenSDA debuggers:</p>
<div class="fragment"><div class="line"># PE Micro OpenSDA</div>
<div class="line"># This file should be installed to /etc/udev/rules.d so that you can access the PE Micro hardware without being root</div>
<div class="line"># e.g., /etc/udev/rules.d/99-PEMicro.rules</div>
<div class="line"> </div>
<div class="line">SUBSYSTEM==&quot;usb&quot;, ENV{DEVTYPE}==&quot;usb_device&quot;, ATTR{idVendor}==&quot;1357&quot;, ATTR{idProduct}==&quot;0089&quot;, MODE=&quot;0666&quot;</div>
</div><!-- fragment --><h3>Compiler and Test Equipment (Optional)</h3>
<ul>
<li>Arm GNU toolchain to re-build the example firmware images.</li>
<li>GNU Make to re-build the example firmware images.</li>
<li>RaspberryPi as test equipment to, e.g., provide stimuli via I2C or SPI to the system under test.</li>
</ul>
<h1>Setup Instructions</h1>
<p >The setup instructions for your platform consist of the platform-specific instructions (either Windows or Linux) and the general instructions below.</p>
<h2>Windows</h2>
<ul>
<li>There are currently no Windows-specific setup steps.</li>
</ul>
<h2>Linux</h2>
<ul>
<li>Make sure that the following packages are installed: <div class="fragment"><div class="line">$ sudo apt-get install libpython2.7 libncurses5</div>
</div><!-- fragment --> <h2>General</h2>
</li>
</ul>
<ul>
<li>Download and install the <a href="https://www.segger.com/downloads/jlink/#J-LinkSoftwareAndDocumentationPack">Segger J-Link software</a> to its default location. The default location is automatically searched by DOTT and it automatically selects the most recent of the installed JLink software versions.</li>
<li>In case your are installing to a non-default location or want to select a particular JLink software version, set the <code>DOTTJLINKPATH</code> environment variable to point to the location of this JLink software version.</li>
<li>If you are using the recommended STM32F072 Nucleo-64 reference board, convert its ST-LINK debugger to a J-Link debugger by the instructions from the <a class="el" href="ReferencePlatform.html">DOTT documentation</a>.</li>
<li>It is assumed that you have a Python interpreter installed. DOTT is currently tested using version 3.10 but should also work with 3.8.</li>
<li>It is recommended (but not required) to create and activate a virtual environment for DOTT: <div class="fragment"><div class="line"># Windows</div>
<div class="line">$ python -m venv dott_venv</div>
<div class="line">$ dott_venv\Scripts\activate.bat</div>
<div class="line"> </div>
<div class="line"># Linux</div>
<div class="line">$ python -m venv dott_venv</div>
<div class="line">$ . dott_venv/bin/activate</div>
</div><!-- fragment --></li>
<li>DOTT can be installed using pip from the official Python Package Index (pypi): <div class="fragment"><div class="line">$ pip install dott-ng</div>
</div><!-- fragment --></li>
<li>Some troubleshooting notes (mostly for Ubuntu Linux):<ul>
<li>If, during <code>pip install</code>, you are seeing error messages such as &lsquo;invalid command 'bdist_wheel&rsquo;<code>or</code>Failed building wheel for ...<code>, run the following command and then re-run the</code>pip install<code>command from above. </code>``shell script $ pip install setuptools wheel twine ``<code></code></li>
<li><code>If, during</code>pip install<code>, you are seeing error messages such as</code>fatal error: Python.h: No such file or directory<code>, install the Python development package using the following command: </code>``shell script $ apt-get install python3-dev ```</li>
</ul>
</li>
<li>If you are using a <code>requirements.txt</code> you can include DOTT as follows: <div class="fragment"><div class="line">...</div>
<div class="line">dott-ng</div>
<div class="line">...</div>
</div><!-- fragment --></li>
<li>This installs all the required dependencies including the <em>dott-ng-runtime</em> package. The <em>dott-ng-runtime</em> contains binary dependencies required by DOTT. This is the GNU debugger (GDB) client for Arm Cortex-M processors (together with its dependencies) as distributed by Arm in the <a href="https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm">GNU Arm Embedded Toolchain</a>.</li>
<li>Download the zip archive with documentation and example projects from the <a href="https://github.com/tw-ghub/dott-ng/releases">DOTT releases website</a> and unpack it to your disk.</li>
<li>Make sure that the STM32F072 Nucleo-64 board is connected to your PC and that its ST-LINK is already converted to J-Link. Open a shell (and activate the DOTT virtual environment if you are using venv). Next, execute the example tests from the zip file: <div class="fragment"><div class="line"># Windows</div>
<div class="line">$ cd examples\01_component_testing\host</div>
<div class="line">$ pytest</div>
<div class="line"> </div>
<div class="line"># Linux</div>
<div class="line">$ cd examples/01_component_testing/host</div>
<div class="line">$ pytest</div>
</div><!-- fragment --></li>
<li>This should generate an output similar to the one below. This indicates that you have correctly installed DOTT and successfully executed your first tests. Please consult the DOTT documentation to learn more about basic <a class="el" href="ComponentTesting.html">component testing</a> as in this example as well as about more advanced <a class="el" href="SystemTesting.html">system testing</a> concepts. <div class="fragment"><div class="line">[INFO] dott.py @197: DOTT runtime:          c:\tmp\venv_dott_install_test/dott_data (package-internal)</div>
<div class="line">[INFO] dott.py @198: DOTT runtime version:  package-internal</div>
<div class="line">[INFO] dott.py @201: work directory:        C:\tmp\dott_ng_doc_examples_20191217\examples</div>
<div class="line">[INFO] dott.py @246: BL ELF (load):         None</div>
<div class="line">[INFO] dott.py @254: BL ELF (symbol):       None</div>
<div class="line">[INFO] dott.py @262: BL ADDR (symbol):      0x0</div>
<div class="line">[INFO] dott.py @268: APP ELF (load):        01_component_testing/target/build/dott_example_01/dott_example_01.bin.elf</div>
<div class="line">[INFO] dott.py @275: APP ELF (symbol):      01_component_testing/target/build/dott_example_01/dott_example_01.axf</div>
<div class="line">[INFO] dott.py @279: Device name:           STM32F072RB</div>
<div class="line">[INFO] dott.py @286: Device endianess:      little</div>
<div class="line">[INFO] dott.py @290: J-LINK interface:      SWD</div>
<div class="line">[INFO] dott.py @294: J-LINK speed (set):    15000</div>
<div class="line">[INFO] dott.py @306: GDB client binary:     c:\tmp\venv_dott_install_test/dott_data/apps/gdb/bin/arm-none-eabi-gdb-py</div>
<div class="line">[INFO] dott.py @314: GDB server address:    10.10.171.84</div>
<div class="line">[INFO] dott.py @320: GDB server port:       2331</div>
<div class="line">[INFO] dott.py @344: GDB server assumed to be already running (not started by DOTT).</div>
<div class="line">[INFO] dott.py @390: Std. target mem model for DOTT default fixtures:  TargetMemModel.TESTHOOK</div>
<div class="line">[INFO] fixtures.py @46: Triggering download of APP to FLASH...</div>
<div class="line">PASSED                                                                                                                                                   [  4%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_NoArgsStatic PASSED                                                                        [  9%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_Addition PASSED                                                                            [ 14%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionPtr PASSED                                                                         [ 19%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionPtr_Alternate PASSED                                                               [ 23%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionPtr_AlternateArray PASSED                                                          [ 28%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionPtrRet PASSED                                                                      [ 33%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionPtrRet_Alternate PASSED                                                            [ 38%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionStruct PASSED                                                                      [ 42%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionStruct_Alternate PASSED                                                            [ 47%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionStruct_ctypes PASSED                                                               [ 52%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionStructPtr PASSED                                                                   [ 57%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionStructPtr_Alternate PASSED                                                         [ 61%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_ManyArgs PASSED                                                                            [ 66%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_CustomOperation PASSED                                                                     [ 71%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_ArgString PASSED                                                                           [ 76%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_SumElements PASSED                                                                         [ 80%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionSubcalls PASSED                                                                    [ 85%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionSubcallsBasicIntercept PASSED                                                      [ 90%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_example_AdditionSubcallsExtIntercept PASSED                                                        [ 95%]</div>
<div class="line">test_example_functions.py::TestExampleFunctions::test_global_data_access PASSED                                                                          [100%]</div>
<div class="line"> </div>
<div class="line">-------------------- generated xml file: C:\tmp\dott_ng_doc_examples_20191217\examples\test_results.xml ---------------------</div>
<div class="line">===================================================================== 21 passed in 10.41s =====================================================================</div>
</div><!-- fragment --> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
